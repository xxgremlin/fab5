From 0b46a1634acc4cf202b2ef22acc186c44cf1b5e3 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Zbigniew=20J=C4=99drzejewski-Szmek?= <zbyszek@in.waw.pl>
Date: Mon, 2 Jun 2025 12:23:36 +0200
Subject: [PATCH] scripts: suppress error about glibc.posttrans scriptlet

Fixes https://github.com/coreos/rpm-ostree/issues/5411. Follow-up for
https://src.fedoraproject.org/rpms/glibc/pull-request/145 (rawhide)
and https://src.fedoraproject.org/rpms/glibc/pull-request/144 (f42).
---
 src/libpriv/rpmostree-scripts.cxx | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/src/libpriv/rpmostree-scripts.cxx b/src/libpriv/rpmostree-scripts.cxx
index bcc9adf3d..cdbce14d2 100644
--- a/src/libpriv/rpmostree-scripts.cxx
+++ b/src/libpriv/rpmostree-scripts.cxx
@@ -167,7 +167,12 @@ static const RpmOstreeLuaReplacement lua_replacements[] = {
    */
   { "glibc.post", "/usr/bin/bash", glibc_post_script },
   /* Code introduced in
-     https://src.fedoraproject.org/rpms/glibc/c/ca0613665ce6e1b4e92dadd3660ad39cf3dc5f3e?branch=main
+   * https://src.fedoraproject.org/rpms/glibc/c/d2ae0e3b919a3c9650cc604af23bb6e9ff97e598?branch=f42.
+   * We don't need to do anything for ostree systems.
+   */
+  { "glibc.posttrans", "/usr/bin/true", "" },
+  /* Code introduced in
+   * https://src.fedoraproject.org/rpms/glibc/c/ca0613665ce6e1b4e92dadd3660ad39cf3dc5f3e?branch=rawhide
    */
   { "glibc-gconv-extra.post", "/usr/bin/bash", glibc_post_script },
   /* See https://bugzilla.redhat.com/show_bug.cgi?id=1847454.
-- 
2.47.1

